<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="445px" preserveAspectRatio="none" style="width:1434px;height:445px;background:#FFFFFF;" version="1.1" viewBox="0 0 1434 445" width="1434px" zoomAndPan="magnify"><defs><filter height="300%" id="fqpae9ynpkvqr" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#F8F8F8" filter="url(#fqpae9ynpkvqr)" height="426.4248" rx="12.5" ry="12.5" style="stroke:#383838;stroke-width:1.5;" width="1415.4794" x="7" y="7"/><rect fill="#FFFFFF" height="392.8154" rx="12.5" ry="12.5" style="stroke:#FFFFFF;stroke-width:1.0;" width="1409.4794" x="10" y="37.6094"/><line style="stroke:#383838;stroke-width:1.5;" x1="7" x2="1422.4794" y1="34.6094" y2="34.6094"/><text fill="#000000" font-family="Helvetica" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="182" x="623.7397" y="26.5332">TimerSecureTurnstileFSM</text><ellipse cx="416.4794" cy="55.6094" fill="#000000" filter="url(#fqpae9ynpkvqr)" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><g id="TimerSecureTurnstileFSM.UNLOCKED"><rect fill="#F8F8F8" filter="url(#fqpae9ynpkvqr)" height="50" rx="12.5" ry="12.5" style="stroke:#383838;stroke-width:1.5;" width="98" x="367.4794" y="102.6094"/><line style="stroke:#383838;stroke-width:1.5;" x1="367.4794" x2="465.4794" y1="130.2188" y2="130.2188"/><text fill="#000000" font-family="Helvetica" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="78" x="377.4794" y="122.1426">UNLOCKED</text></g><g id="TimerSecureTurnstileFSM.LOCKED"><rect fill="#F8F8F8" filter="url(#fqpae9ynpkvqr)" height="50" rx="12.5" ry="12.5" style="stroke:#383838;stroke-width:1.5;" width="78" x="377.4794" y="331.6094"/><line style="stroke:#383838;stroke-width:1.5;" x1="377.4794" x2="455.4794" y1="359.2188" y2="359.2188"/><text fill="#000000" font-family="Helvetica" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="58" x="387.4794" y="351.1426">LOCKED</text></g><!--MD5=[e94777a82bbc93a409d8dea03011b069]
link *start*TimerSecureTurnstileFSM to UNLOCKED--><path d="M416.4794,65.7604 C416.4794,73.7954 416.4794,85.9354 416.4794,97.2634 " fill="none" id="*start*TimerSecureTurnstileFSM-to-UNLOCKED" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="416.4794,102.3934,420.4794,93.3934,416.4794,97.3934,412.4794,93.3934,416.4794,102.3934" style="stroke:#383838;stroke-width:1.0;"/><!--MD5=[5d767a4319f708ea6a1e1270c7244025]
link LOCKED to LOCKED--><path d="M455.6414,348.3208 C465.8114,348.8303 473.4794,351.5931 473.4794,356.6094 C473.4794,360.7635 468.2204,363.3722 460.6374,364.4356 " fill="none" id="LOCKED-to-LOCKED" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="455.6414,364.898,464.9722,368.0504,460.6201,364.4366,464.2339,360.0845,455.6414,364.898" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112" x="479.4794" y="319.1792">CARD [cardId-&gt;</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="495.4794" y="336.1528">requireNotNull(cardId);</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="312" x="495.4794" y="353.1265">isOverrideCard(cardId)&amp;&amp;overrideActive;</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="479.4794" y="370.1001">] -&gt; {</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="495.4794" y="387.0737">cancelOverride()</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="479.4794" y="404.0474">}</text><!--MD5=[5d767a4319f708ea6a1e1270c7244025]
link LOCKED to LOCKED--><path d="M455.7534,347.1592 C557.1604,334.9209 813.4794,338.071 813.4794,356.6094 C813.4794,374.84 565.6004,378.1891 460.9294,366.6564 " fill="none" id="LOCKED-to-LOCKED-1" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="455.7534,366.0596,464.2359,371.0644,460.7205,366.6324,465.1525,363.1171,455.7534,366.0596" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112" x="819.4794" y="319.1792">CARD [cardId-&gt;</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="835.4794" y="336.1528">requireNotNull(cardId);</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="835.4794" y="353.1265">isOverrideCard(cardId);</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="819.4794" y="370.1001">] -&gt; {</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="144" x="835.4794" y="387.0737">activateOverride()</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="819.4794" y="404.0474">}</text><!--MD5=[c03bbcbe1ea2187b5aae6c6faf6bf9ae]
link LOCKED to UNLOCKED--><path d="M455.8354,351.0115 C500.5624,343.4482 571.6104,323.8056 604.4794,273.6094 C629.5574,235.3114 633.1034,206.3344 604.4794,170.6094 C587.9514,149.9814 520.1564,138.8144 470.7074,133.2894 " fill="none" id="LOCKED-to-UNLOCKED" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="465.6804,132.7404,474.1915,137.6964,470.6507,133.2847,475.0624,129.7439,465.6804,132.7404" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112" x="625.4794" y="184.6792">CARD [cardId-&gt;</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="641.4794" y="201.6528">requireNotNull(cardId);</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="288" x="641.4794" y="218.6265">overrideActive||isValidCard(cardId);</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="625.4794" y="235.6001">] -&gt; {</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="64" x="641.4794" y="252.5737">unlock()</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="625.4794" y="269.5474">}</text><!--MD5=[5d767a4319f708ea6a1e1270c7244025]
link LOCKED to LOCKED--><path d="M455.6004,344.9625 C591.7934,323.709 1025.4794,327.5913 1025.4794,356.6094 C1025.4794,385.2591 602.7354,389.4071 460.9304,369.0536 " fill="none" id="LOCKED-to-LOCKED-2" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="455.6004,368.2563,463.9093,373.5442,460.5454,368.9963,465.0933,365.6323,455.6004,368.2563" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112" x="1031.4794" y="310.6792">CARD [cardId-&gt;</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="360" x="1047.4794" y="327.6528">requireNotNull(cardId){"cardId is required"};</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="168" x="1047.4794" y="344.6265">!isValidCard(cardId);</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112" x="1031.4794" y="361.6001">] -&gt; {cardId-&gt;</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="176" x="1047.4794" y="378.5737">requireNotNull(cardId)</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="152" x="1047.4794" y="395.5474">invalidCard(cardId)</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="1031.4794" y="412.521">}</text><!--MD5=[33c2fb760a7074ec24359010ff9693f6]
link UNLOCKED to LOCKED--><path d="M367.3094,130.6434 C271.9454,135.0934 69.3511,147.2204 48.4793,170.6094 C18,204.7654 19.8452,237.8924 48.4793,273.6094 C88.6224,323.682 283.1884,345.1571 372.0504,352.4659 " fill="none" id="UNLOCKED-to-LOCKED" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="377.2324,352.8859,368.5853,348.1712,372.2488,352.4816,367.9385,356.1451,377.2324,352.8859" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="208" x="49.4793" y="201.6792">«timeout = {timeout}» -&gt; {</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="216" x="65.4793" y="218.6528">println("Timeout. Locking")</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="65.4793" y="235.6265">lock()</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="49.4793" y="252.6001">}</text><!--MD5=[33c2fb760a7074ec24359010ff9693f6]
link UNLOCKED to LOCKED--><path d="M367.3954,134.4194 C344.5904,139.8544 319.4734,150.3514 305.4794,170.6094 C279.4604,208.2734 284.8584,232.7394 305.4794,273.6094 C319.5504,301.4994 348.0824,322.2508 372.6944,335.9005 " fill="none" id="UNLOCKED-to-LOCKED-1" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="377.2394,338.3666,371.2361,330.5589,372.8445,335.9823,367.4212,337.5907,377.2394,338.3666" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112" x="306.4794" y="184.6792">CARD [cardId-&gt;</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="322.4794" y="201.6528">requireNotNull(cardId);</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="322.4794" y="218.6265">isOverrideCard(cardId);</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="306.4794" y="235.6001">] -&gt; {</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="322.4794" y="252.5737">lock()</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="306.4794" y="269.5474">}</text><!--MD5=[33c2fb760a7074ec24359010ff9693f6]
link UNLOCKED to LOCKED--><path d="M465.7454,139.8754 C481.8454,146.1464 498.0074,155.8064 507.4794,170.6094 C532.1514,209.1694 526.0904,231.7854 507.4794,273.6094 C497.5114,296.0084 478.0684,314.8624 459.7034,328.8219 " fill="none" id="UNLOCKED-to-LOCKED-2" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="455.5604,331.9046,465.169,329.7421,459.5721,328.9202,460.394,323.3234,455.5604,331.9046" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="72" x="524.4794" y="210.1792">PASS -&gt; {</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="540.4794" y="227.1528">lock()</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="524.4794" y="244.1265">}</text><!--MD5=[1405eb19551f376e25844bf6972855ac]
@startuml
skinparam monochrome true
skinparam StateFontName Helvetica
skinparam defaultFontName Monospaced
skinparam defaultFontStyle Bold
skinparam state {
    FontStyle Bold
}
state TimerSecureTurnstileFSM {
[*] - -> UNLOCKED
LOCKED - -> LOCKED : CARD [cardId->\l  requireNotNull(cardId);\l  isOverrideCard(cardId)&&overrideActive;\l] -> {\l  cancelOverride()\l}
LOCKED - -> LOCKED : CARD [cardId->\l  requireNotNull(cardId);\l  isOverrideCard(cardId);\l] -> {\l  activateOverride()\l}
LOCKED - -> UNLOCKED : CARD [cardId->\l  requireNotNull(cardId);\l  overrideActive||isValidCard(cardId);\l] -> {\l  unlock()\l}
LOCKED - -> LOCKED : CARD [cardId->\l  requireNotNull(cardId){"cardId is required"};\l  !isValidCard(cardId);\l] -> {cardId->\l  requireNotNull(cardId)\l  invalidCard(cardId)\l}
UNLOCKED - -> LOCKED : <<timeout = {timeout}>> -> {\l  println("Timeout. Locking")\l  lock()\l}
UNLOCKED - -> LOCKED : CARD [cardId->\l  requireNotNull(cardId);\l  isOverrideCard(cardId);\l] -> {\l  lock()\l}
UNLOCKED - -> LOCKED : PASS -> {\l  lock()\l}
}
@enduml

PlantUML version 1.2021.7(Sun May 23 14:40:07 CAT 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: ZA
--></g></svg>